<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.tzg.entitys.subjectplan.SubjectplanMapper">	
	<resultMap id="BaseResultMap" type="com.tzg.entitys.subjectplan.Subjectplan">
		<result property="id" jdbcType="INTEGER" column="id"/>
		<result property="iloginAccountId" jdbcType="INTEGER" column="iLoginAccountID"/>
		<result property="isubjectId" jdbcType="INTEGER" column="iSubjectID"/>
		<result property="itype" jdbcType="INTEGER" column="iType"/>
		<result property="numTotalPeriod" jdbcType="INTEGER" column="numTotalPeriod"/>
		<result property="numCurrentPeriod" jdbcType="INTEGER" column="numCurrentPeriod"/>
		<result property="numRepayAmount" jdbcType="DECIMAL" column="numRepayAmount"/>
		<result property="numRepayCorpus" jdbcType="DECIMAL" column="numRepayCorpus"/>
		<result property="numRepayInterest" jdbcType="DECIMAL" column="numRepayInterest"/>
		<result property="dtRepay" jdbcType="DATE" column="dtRepay"/>
		<result property="dtCreate" jdbcType="TIMESTAMP" column="dtCreate"/>
    </resultMap>
	
	<sql id="columns">
	    <![CDATA[
        id ,iLoginAccountID ,iSubjectID ,iType ,numTotalPeriod ,numCurrentPeriod ,numRepayAmount ,numRepayCorpus ,numRepayInterest ,dtRepay ,dtCreate 
	    ]]>
	</sql>
    <insert id="savePlanList" parameterType="java.util.List" useGeneratedKeys="true" keyProperty="id">
        <selectKey resultType="java.lang.Integer" keyProperty="id" order="AFTER" >
            SELECT LAST_INSERT_ID() AS id
        </selectKey>
        INSERT INTO tbsubjectplan (
        iLoginAccountID ,
        iSubjectID ,
        iType ,
        numTotalPeriod ,
        numCurrentPeriod ,
        numRepayAmount ,
        numRepayCorpus ,
        numRepayInterest ,
        dtRepay ,
        dtCreate
        ) VALUES
        <foreach collection="list" item="item" index="index"
                 separator=",">
            (#{item.iloginAccountId,jdbcType=INTEGER} ,
            #{item.isubjectId,jdbcType=INTEGER} ,
            #{item.itype,jdbcType=INTEGER} ,
            #{item.numTotalPeriod,jdbcType=INTEGER} ,
            #{item.numCurrentPeriod,jdbcType=INTEGER} ,
            #{item.numRepayAmount,jdbcType=DECIMAL} ,
            #{item.numRepayCorpus,jdbcType=DECIMAL} ,
            #{item.numRepayInterest,jdbcType=DECIMAL} ,
            #{item.dtRepay,jdbcType=DATE} ,
            #{item.dtCreate,jdbcType=TIMESTAMP})
        </foreach>
    </insert>
	
	<insert id="save" parameterType="com.tzg.entitys.subjectplan.Subjectplan" useGeneratedKeys="true" keyProperty="id">
		<selectKey resultType="java.lang.Integer" keyProperty="id" order="AFTER" >
	      SELECT LAST_INSERT_ID() AS id
	    </selectKey>
	<![CDATA[
		INSERT INTO tbsubjectplan (
        	iLoginAccountID ,
        	iSubjectID ,
        	iType ,
        	numTotalPeriod ,
        	numCurrentPeriod ,
        	numRepayAmount ,
        	numRepayCorpus ,
        	numRepayInterest ,
        	dtRepay ,
        	dtCreate 
		) VALUES (
        	#{iloginAccountId,jdbcType=INTEGER} ,
        	#{isubjectId,jdbcType=INTEGER} ,
        	#{itype,jdbcType=INTEGER} ,
        	#{numTotalPeriod,jdbcType=INTEGER} ,
        	#{numCurrentPeriod,jdbcType=INTEGER} ,
        	#{numRepayAmount,jdbcType=DECIMAL} ,
        	#{numRepayCorpus,jdbcType=DECIMAL} ,
        	#{numRepayInterest,jdbcType=DECIMAL} ,
        	#{dtRepay,jdbcType=DATE} ,
        	#{dtCreate,jdbcType=TIMESTAMP} 
		)
	]]>
	</insert>

	<update id="update" parameterType="com.tzg.entitys.subjectplan.Subjectplan">
		UPDATE tbsubjectplan
		<set>
			<if test="iloginAccountId != null">
	        iLoginAccountID = #{iloginAccountId,jdbcType=INTEGER} ,
	        </if>
			<if test="isubjectId != null">
	        iSubjectID = #{isubjectId,jdbcType=INTEGER} ,
	        </if>
			<if test="itype != null">
	        iType = #{itype,jdbcType=INTEGER} ,
	        </if>
			<if test="numTotalPeriod != null">
	        numTotalPeriod = #{numTotalPeriod,jdbcType=INTEGER} ,
	        </if>
			<if test="numCurrentPeriod != null">
	        numCurrentPeriod = #{numCurrentPeriod,jdbcType=INTEGER} ,
	        </if>
			<if test="numRepayAmount != null">
	        numRepayAmount = #{numRepayAmount,jdbcType=DECIMAL} ,
	        </if>
			<if test="numRepayCorpus != null">
	        numRepayCorpus = #{numRepayCorpus,jdbcType=DECIMAL} ,
	        </if>
			<if test="numRepayInterest != null">
	        numRepayInterest = #{numRepayInterest,jdbcType=DECIMAL} ,
	        </if>
			<if test="dtRepay != null">
	        dtRepay = #{dtRepay,jdbcType=DATE} ,
	        </if>
			<if test="dtCreate != null">
	        dtCreate = #{dtCreate,jdbcType=TIMESTAMP} 
	        </if>
	    </set>
		WHERE 
	        id = #{id,jdbcType=INTEGER} 
	</update>

	<delete id="deleteById" parameterType="java.lang.Integer">
	<![CDATA[
		DELETE FROM tbsubjectplan WHERE
        id = #{id} 
	]]>
	</delete>
    
	<select id="findById" resultMap="BaseResultMap" parameterType="java.lang.Integer">
	    SELECT <include refid="columns"/> 
	<![CDATA[
		FROM tbsubjectplan 
		WHERE 
        id = #{id} 
	]]>
	</select>
	 
	<select id="findPageCount" resultType="java.lang.Integer" parameterType="java.util.Map">
    	select count(*) from tbsubjectplan where 1=1
		<include refid="queryWhere"/>
	</select>
    
	<select id="findPage" resultMap="BaseResultMap" parameterType="java.util.Map">
		select <include refid="columns"/>  from tbsubjectplan where 1=1
		<include refid="queryWhere"/> 
	   <choose>
	            <when test="sortField != null and sortField != ''">
	               ORDER BY ${sortField} asc
	            </when>
	            <otherwise>
	                 ORDER BY id ASC 
	            </otherwise>
	        </choose>
        <![CDATA[ LIMIT ${startRecord},${endRecord} ]]>
	</select>
	
	<sql id="queryWhere">
		<if test="id != null and id.trim() != ''">
		and id = #{id}
		</if>
		<if test="iloginAccountId != null and iloginAccountId.trim() != ''">
		and iLoginAccountID = #{iloginAccountId}
		</if>
		<if test="isubjectId != null and isubjectId.trim() != ''">
		and iSubjectID = #{isubjectId}
		</if>
		<if test="itype != null and itype.trim() != ''">
		and iType = #{itype}
		</if>
		<if test="numTotalPeriod != null and numTotalPeriod.trim() != ''">
		and numTotalPeriod = #{numTotalPeriod}
		</if>
		<if test="numCurrentPeriod != null and numCurrentPeriod.trim() != ''">
		and numCurrentPeriod = #{numCurrentPeriod}
		</if>
		<if test="numRepayAmount != null and numRepayAmount.trim() != ''">
		and numRepayAmount = #{numRepayAmount}
		</if>
		<if test="numRepayCorpus != null and numRepayCorpus.trim() != ''">
		and numRepayCorpus = #{numRepayCorpus}
		</if>
		<if test="numRepayInterest != null and numRepayInterest.trim() != ''">
		and numRepayInterest = #{numRepayInterest}
		</if>
		<if test="dtRepayBegin != null and dtRepayBegin.trim() != ''">
		and dtRepay >= #{dtRepayBegin}
		</if>
		<if test="dtRepayEnd != null and dtRepayEnd.trim() != ''">
		and dtRepay &lt;= #{dtRepayEnd}
		</if>
		<if test="dtCreateBegin != null and dtCreateBegin.trim() != ''">
		and dtCreate >= #{dtCreateBegin}
		</if>
		<if test="dtCreateEnd != null and dtCreateEnd.trim() != ''">
		and dtCreate &lt;= #{dtCreateEnd}
		</if>
	</sql>
</mapper>



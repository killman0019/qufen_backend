<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.tzg.entitys.activerewardrecord.ActiverewardrecordMapper">	
	<resultMap id="BaseResultMap" type="com.tzg.entitys.activerewardrecord.Activerewardrecord">
		<result property="id" jdbcType="INTEGER" column="ID"/>
		<result property="iactiveId" jdbcType="INTEGER" column="iActiveID"/>
		<result property="iloginAccountId" jdbcType="INTEGER" column="iLoginAccountID"/>
		<result property="ilevel" jdbcType="INTEGER" column="iLevel"/>
		<result property="dtCreate" jdbcType="TIMESTAMP" column="dtCreate"/>
		<result property="dtUpdate" jdbcType="TIMESTAMP" column="dtUpdate"/>
		<result property="useName" jdbcType="VARCHAR" column="useName"/>
		<result property="vcLoginName" jdbcType="VARCHAR" column="vcLoginName"/>
		<result property="phone" jdbcType="VARCHAR" column="phone"/>
		<result property="prize" jdbcType="VARCHAR" column="prize"/>
    </resultMap>
	
	<sql id="columns">
	    <![CDATA[
        ID ,iActiveID ,iLoginAccountID ,iLevel ,dtCreate ,dtUpdate 
	    ]]>
	</sql>
	
	<sql id="columns1">
	    <![CDATA[
        t1.ID ,t1.iActiveID ,t1.iLoginAccountID ,t1.iLevel ,t1.dtCreate ,t1.dtUpdate 
	    ]]>
	</sql>
	
	<insert id="save" parameterType="com.tzg.entitys.activerewardrecord.Activerewardrecord" useGeneratedKeys="true" keyProperty="id">
		<selectKey resultType="java.lang.Integer" keyProperty="id" order="AFTER" >
	      SELECT LAST_INSERT_ID() AS id
	    </selectKey>
	<![CDATA[
		INSERT INTO tbactiverewardrecord (
        	iActiveID ,
        	iLoginAccountID ,
        	iLevel ,
        	dtCreate ,
        	dtUpdate 
		) VALUES (
        	#{iactiveId,jdbcType=INTEGER} ,
        	#{iloginAccountId,jdbcType=INTEGER} ,
        	#{ilevel,jdbcType=INTEGER} ,
        	#{dtCreate,jdbcType=TIMESTAMP} ,
        	#{dtUpdate,jdbcType=TIMESTAMP} 
		)
	]]>
	</insert>

	<update id="update" parameterType="com.tzg.entitys.activerewardrecord.Activerewardrecord">
		UPDATE tbactiverewardrecord
		<set>
			<if test="iactiveId != null">
	        iActiveID = #{iactiveId,jdbcType=INTEGER} ,
	        </if>
			<if test="iloginAccountId != null">
	        iLoginAccountID = #{iloginAccountId,jdbcType=INTEGER} ,
	        </if>
			<if test="ilevel != null">
	        iLevel = #{ilevel,jdbcType=INTEGER} ,
	        </if>
			<if test="dtCreate != null">
	        dtCreate = #{dtCreate,jdbcType=TIMESTAMP} ,
	        </if>
			<if test="dtUpdate != null">
	        dtUpdate = #{dtUpdate,jdbcType=TIMESTAMP} 
	        </if>
	    </set>
		WHERE 
	        ID = #{id,jdbcType=INTEGER} 
	</update>

	<delete id="deleteById" parameterType="java.lang.Integer">
	<![CDATA[
		DELETE FROM tbactiverewardrecord WHERE
        ID = #{id} 
	]]>
	</delete>
    
	<select id="findById" resultMap="BaseResultMap" parameterType="java.lang.Integer">
	    SELECT <include refid="columns"/> 
	<![CDATA[
		FROM tbactiverewardrecord 
		WHERE 
        ID = #{id} 
	]]>
	</select>
	 
	<select id="findPageCount" resultType="java.lang.Integer" parameterType="java.util.Map">
    	select count(*) from tbactiverewardrecord t1, tbloginaccount t2,tbactivereward t3 where 1=1
			<if test="dtbeginStr != null and dtbeginStr != ''">
		and DATE_FORMAT(t1.dtcreate,'%Y-%m-%d') &gt;= #{dtbeginStr}
		</if>
		<if test="dtendStr != null and dtendStr != ''">
		and DATE_FORMAT(t1.dtcreate,'%Y-%m-%d') &lt;= #{dtendStr}
		</if>
		<if test="phone != null and phone.trim() != ''">
		and t2.vcPhone = #{phone}
		</if>
		<if test="iactiveId != null and iactiveId.trim() != ''">
		and t1.iActiveID = #{iactiveId}
		</if>
		and t1.iLoginAccountID =t2.id 
		and t1.iActiveID =t3.iActiveID
		and t1.iLevel=t3.iLevel 
	</select>
    
	<select id="findPage" resultMap="BaseResultMap" parameterType="java.util.Map">
		select <include refid="columns1"/>, t2.vcPhone as phone ,t2.vcName as useName,t2.vcloginName as vcLoginName,t3.vcName as prize from tbactiverewardrecord t1, tbloginaccount t2,tbactivereward t3 where 1=1
		<if test="dtbeginStr != null and dtbeginStr != ''">
		and DATE_FORMAT(t1.dtcreate,'%Y-%m-%d') &gt;= #{dtbeginStr}
		</if>
		<if test="dtendStr != null and dtendStr != ''">
		and DATE_FORMAT(t1.dtcreate,'%Y-%m-%d') &lt;= #{dtendStr}
		</if>
		<if test="phone != null and phone.trim() != ''">
		and t2.vcPhone = #{phone}
		</if>
		<if test="iactiveId != null and iactiveId.trim() != ''">
		and t1.iActiveID = #{iactiveId}
		</if>
		and t1.iLoginAccountID =t2.id 
		and t1.iActiveID =t3.iActiveID
		and t1.iLevel=t3.iLevel 
		
	    <![CDATA[ ORDER BY id DESC ]]>
	    <if test="startRecord != null and endRecord != ''">
        <![CDATA[ LIMIT ${startRecord},${endRecord} ]]>
        </if>
	</select>
	
	
	
	
	
	
	<sql id="queryWhere">
		<if test="id != null and id.trim() != ''">
		and ID = #{id}
		</if>
		<if test="iactiveId != null and iactiveId.trim() != ''">
		and iActiveID = #{iactiveId}
		</if>
		<if test="iloginAccountId != null and iloginAccountId.trim() != ''">
		and iLoginAccountID = #{iloginAccountId}
		</if>
		<if test="ilevel != null and ilevel.trim() != ''">
		and iLevel = #{ilevel}
		</if>
		<if test="dtCreateBegin != null and dtCreateBegin.trim() != ''">
		and dtCreate >= #{dtCreateBegin}
		</if>
		<if test="dtCreateEnd != null and dtCreateEnd.trim() != ''">
		and dtCreate &lt;= #{dtCreateEnd}
		</if>
		<if test="dtUpdateBegin != null and dtUpdateBegin.trim() != ''">
		and dtUpdate >= #{dtUpdateBegin}
		</if>
		<if test="dtUpdateEnd != null and dtUpdateEnd.trim() != ''">
		and dtUpdate &lt;= #{dtUpdateEnd}
		</if>
	</sql>
</mapper>



<?xml version="1.0" encoding="UTF-8"?>
<beans xmlns="http://www.springframework.org/schema/beans"
	xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
	xmlns:context="http://www.springframework.org/schema/context"
	xmlns:mvc="http://www.springframework.org/schema/mvc"
	xsi:schemaLocation="http://www.springframework.org/schema/mvc http://www.springframework.org/schema/mvc/spring-mvc-3.1.xsd
		http://www.springframework.org/schema/beans http://www.springframework.org/schema/beans/spring-beans-3.1.xsd
		http://www.springframework.org/schema/context http://www.springframework.org/schema/context/spring-context-3.1.xsd">
	
	<!-- 使用annotation 自动注册bean, 并保证@Required、@Autowired的属性被注入 -->
	<context:component-scan base-package="com.tzg.wap.*"/>
    
	<!-- 静态文件在web.xml中已配置default servlet处理. <mvc:default-servlet-handler/> -->
	<mvc:annotation-driven>  
        <mvc:message-converters>  
            <bean class="com.tzg.wap.utils.UTF8StringHttpMessageConverter" />  
        </mvc:message-converters>  
    </mvc:annotation-driven> 
	<bean class="org.springframework.web.servlet.mvc.annotation.AnnotationMethodHandlerAdapter">
		<property name="messageConverters">
			<list>
				<ref bean="mappingJacksonHttpMessageConverter" />
			</list>
		</property>
	</bean>

	<bean id="mappingJacksonHttpMessageConverter" class="org.springframework.http.converter.json.MappingJacksonHttpMessageConverter">
		<property name="supportedMediaTypes">
			<list>
				<value>application/json;charset=UTF-8</value>
			</list>
		</property>
	</bean>
	
	<mvc:interceptors>  
   		<!-- notAllowedSuffixes不允许的非法后缀,基于黑名单。一般应该采用白名单：限定请求后缀比如.htm,
		由于是已有系统,限定后缀代码改动量会比较大，所以不得已采用黑名单 -->
 	<bean class="com.tzg.wap.interceptor.ContextInterceptor" /> 
    	<bean class="com.tzg.wap.interceptor.AuthorityAnnotationInterceptor"   >
    		<property name="notAllowedSuffixes">
    			<array value-type="java.lang.String">
    				<value>.old</value>
    				<value>.arc</value>
    			</array>
    		</property>
    	</bean>
    	<bean class="com.tzg.wap.interceptor.CsrfIntercepter">
    	    <property name="excludeUrls">
    			<array value-type="java.lang.String">
    			    <value>https://yintong.com.cn</value>
    				<value>http://yintong.com.cn</value>
    				<value>http://122.224.156.194</value>
    				<value>http://192.168.1.17</value>
    				<value>http://192.168.1.7</value>
    			</array>
    		</property>
    		<property name="errorPage" value="/error/500"/>
    	</bean>
    	
	</mvc:interceptors>
	
</beans>

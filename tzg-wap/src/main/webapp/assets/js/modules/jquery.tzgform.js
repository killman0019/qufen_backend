/*!
 * jQuery form ajax submit
 * includes jquery.validate.js and jquery.form.js
 */

(function (factory) {
	if (typeof define === "function") {
		if (define.amd) {
			define (["jquery"], factory);
		}
		else if (define.cmd) {
			define (function(require) {
				var jQuery = require("jquery");
				factory(jQuery);
			});
		}
	}
	else {
		factory (jQuery);
	}
}(function($) {
	// jquery.validate.js
	$.extend($.fn,{validate:function(a){if(!this.length){if(a&&a.debug&&window.console){console.warn("Nothing selected, can't validate, returning nothing.")}return}var b=$.data(this[0],"validator");if(b){return b}this.attr("novalidate","novalidate");b=new $.validator(a,this[0]);$.data(this[0],"validator",b);if(b.settings.onsubmit){this.validateDelegate(":submit","click",function(c){if(b.settings.submitHandler){b.submitButton=c.target}if($(c.target).hasClass("cancel")){b.cancelSubmit=true}if($(c.target).attr("formnovalidate")){b.cancelSubmit=true}});this.submit(function(c){if(b.settings.debug){c.preventDefault()}function d(){var e;if(b.settings.submitHandler){if(b.submitButton){e=$("<input type='hidden'/>").attr("name",b.submitButton.name).val($(b.submitButton).val()).appendTo(b.currentForm)}b.settings.submitHandler.call(b,b.currentForm,c);if(b.submitButton){e.remove()}return false}return true}if(b.cancelSubmit){b.cancelSubmit=false;return d()}if(b.form()){if(b.pendingRequest){b.formSubmitted=true;return false}return d()}else{b.focusInvalid();return false}})}return b},valid:function(){var b,a;if($(this[0]).is("form")){b=this.validate().form()}else{b=true;a=$(this[0].form).validate();this.each(function(){b=a.element(this)&&b})}return b},removeAttrs:function(c){var a={},b=this;$.each(c.split(/\s/),function(d,e){a[e]=b.attr(e);b.removeAttr(e)});return a},rules:function(d,a){var f=this[0],c,h,i,e,b,g;if(d){c=$.data(f.form,"validator").settings;h=c.rules;i=$.validator.staticRules(f);switch(d){case"add":$.extend(i,$.validator.normalizeRule(a));delete i.messages;h[f.name]=i;if(a.messages){c.messages[f.name]=$.extend(c.messages[f.name],a.messages)}break;case"remove":if(!a){delete h[f.name];return i}g={};$.each(a.split(/\s/),function(j,k){g[k]=i[k];delete i[k];if(k==="required"){$(f).removeAttr("aria-required")}});return g}}e=$.validator.normalizeRules($.extend({},$.validator.classRules(f),$.validator.attributeRules(f),$.validator.dataRules(f),$.validator.staticRules(f)),f);if(e.required){b=e.required;delete e.required;e=$.extend({required:b},e);$(f).attr("aria-required","true")}if(e.remote){b=e.remote;delete e.remote;e=$.extend(e,{remote:b})}return e}});$.extend($.expr[":"],{blank:function(b){return !$.trim(""+$(b).val())},filled:function(b){return !!$.trim(""+$(b).val())},unchecked:function(b){return !$(b).prop("checked")}});$.validator=function(a,b){this.settings=$.extend(true,{},$.validator.defaults,a);this.currentForm=b;this.init()};$.validator.format=function(a,b){if(arguments.length===1){return function(){var c=$.makeArray(arguments);c.unshift(a);return $.validator.format.apply(this,c)}}if(arguments.length>2&&b.constructor!==Array){b=$.makeArray(arguments).slice(1)}if(b.constructor!==Array){b=[b]}$.each(b,function(c,d){a=a.replace(new RegExp("\\{"+c+"\\}","g"),function(){return d})});return a};$.extend($.validator,{defaults:{messages:{},groups:{},rules:{},errorClass:"error",validClass:"valid",errorElement:"label",focusInvalid:true,errorContainer:$([]),errorLabelContainer:$([]),onsubmit:true,ignore:":hidden",ignoreTitle:false,onfocusin:function(a){this.lastActive=a;if(this.settings.focusCleanup&&!this.blockFocusCleanup){if(this.settings.unhighlight){this.settings.unhighlight.call(this,a,this.settings.errorClass,this.settings.validClass)}this.hideThese(this.errorsFor(a))}},onfocusout:function(a){if(!this.checkable(a)&&(a.name in this.submitted||!this.optional(a))){this.element(a)}},onkeyup:function(a,b){if(b.which===9&&this.elementValue(a)===""){return}else{if(a.name in this.submitted||a===this.lastElement){this.element(a)}}},onclick:function(a){if(a.name in this.submitted){this.element(a)}else{if(a.parentNode.name in this.submitted){this.element(a.parentNode)}}},highlight:function(c,a,b){if(c.type==="radio"){this.findByName(c.name).addClass(a).removeClass(b)}else{$(c).addClass(a).removeClass(b)}},unhighlight:function(c,a,b){if(c.type==="radio"){this.findByName(c.name).removeClass(a).addClass(b)}else{$(c).removeClass(a).addClass(b)}}},setDefaults:function(a){$.extend($.validator.defaults,a)},messages:{required:"This field is required.",remote:"Please fix this field.",email:"Please enter a valid email address.",url:"Please enter a valid URL.",date:"Please enter a valid date.",dateISO:"Please enter a valid date ( ISO ).",number:"Please enter a valid number.",digits:"Please enter only digits.",creditcard:"Please enter a valid credit card number.",equalTo:"Please enter the same value again.",maxlength:$.validator.format("Please enter no more than {0} characters."),minlength:$.validator.format("Please enter at least {0} characters."),rangelength:$.validator.format("Please enter a value between {0} and {1} characters long."),range:$.validator.format("Please enter a value between {0} and {1}."),max:$.validator.format("Please enter a value less than or equal to {0}."),min:$.validator.format("Please enter a value greater than or equal to {0}.")},autoCreateRanges:false,prototype:{init:function(){this.labelContainer=$(this.settings.errorLabelContainer);this.errorContext=this.labelContainer.length&&this.labelContainer||$(this.currentForm);this.containers=$(this.settings.errorContainer).add(this.settings.errorLabelContainer);this.submitted={};this.valueCache={};this.pendingRequest=0;this.pending={};this.invalid={};this.reset();var a=(this.groups={}),c;$.each(this.settings.groups,function(d,e){if(typeof e==="string"){e=e.split(/\s/)}$.each(e,function(g,f){a[f]=d})});c=this.settings.rules;$.each(c,function(d,e){c[d]=$.validator.normalizeRule(e)});function b(g){var e=$.data(this[0].form,"validator"),d="on"+g.type.replace(/^validate/,""),f=e.settings;if(f[d]&&!this.is(f.ignore)){f[d].call(e,this[0],g)}}$(this.currentForm).validateDelegate(":text, [type='password'], [type='file'], select, textarea, [type='number'], [type='search'] ,[type='tel'], [type='url'], [type='email'], [type='datetime'], [type='date'], [type='month'], [type='week'], [type='time'], [type='datetime-local'], [type='range'], [type='color'], [type='radio'], [type='checkbox']","focusin focusout keyup",b).validateDelegate("select, option, [type='radio'], [type='checkbox']","click",b);if(this.settings.invalidHandler){$(this.currentForm).bind("invalid-form.validate",this.settings.invalidHandler)}$(this.currentForm).find("[required], [data-rule-required], .required").attr("aria-required","true")},form:function(){this.checkForm();$.extend(this.submitted,this.errorMap);this.invalid=$.extend({},this.errorMap);if(!this.valid()){$(this.currentForm).triggerHandler("invalid-form",[this])}this.showErrors();return this.valid()},checkForm:function(){this.prepareForm();for(var a=0,b=(this.currentElements=this.elements());b[a];a++){this.check(b[a])}return this.valid()},element:function(c){var d=this.clean(c),b=this.validationTargetFor(d),a=true;this.lastElement=b;if(b===undefined){delete this.invalid[d.name]}else{this.prepareElement(b);this.currentElements=$(b);a=this.check(b)!==false;if(a){delete this.invalid[b.name]}else{this.invalid[b.name]=true}}$(c).attr("aria-invalid",!a);if(!this.numberOfInvalids()){this.toHide=this.toHide.add(this.containers)}this.showErrors();return a},showErrors:function(b){if(b){$.extend(this.errorMap,b);this.errorList=[];for(var a in b){this.errorList.push({message:b[a],element:this.findByName(a)[0]})}this.successList=$.grep(this.successList,function(c){return !(c.name in b)})}if(this.settings.showErrors){this.settings.showErrors.call(this,this.errorMap,this.errorList)}else{this.defaultShowErrors()}},resetForm:function(){if($.fn.resetForm){$(this.currentForm).resetForm()}this.submitted={};this.lastElement=null;this.prepareForm();this.hideErrors();this.elements().removeClass(this.settings.errorClass).removeData("previousValue").removeAttr("aria-invalid")},numberOfInvalids:function(){return this.objectLength(this.invalid)},objectLength:function(c){var b=0,a;for(a in c){b++}return b},hideErrors:function(){this.hideThese(this.toHide)},hideThese:function(a){a.not(this.containers).text("");this.addWrapper(a).hide()},valid:function(){return this.size()===0},size:function(){return this.errorList.length},focusInvalid:function(){if(this.settings.focusInvalid){try{$(this.findLastActive()||this.errorList.length&&this.errorList[0].element||[]).filter(":visible").focus().trigger("focusin")}catch(a){}}},findLastActive:function(){var a=this.lastActive;return a&&$.grep(this.errorList,function(b){return b.element.name===a.name}).length===1&&a},elements:function(){var b=this,a={};return $(this.currentForm).find("input, select, textarea").not(":submit, :reset, :image, [disabled]").not(this.settings.ignore).filter(function(){if(!this.name&&b.settings.debug&&window.console){console.error("%o has no name assigned",this)}if(this.name in a||!b.objectLength($(this).rules())){return false}a[this.name]=true;return true})},clean:function(a){return $(a)[0]},errors:function(){var a=this.settings.errorClass.split(" ").join(".");return $(this.settings.errorElement+"."+a,this.errorContext)},reset:function(){this.successList=[];this.errorList=[];this.errorMap={};this.toShow=$([]);this.toHide=$([]);this.currentElements=$([])},prepareForm:function(){this.reset();this.toHide=this.errors().add(this.containers)},prepareElement:function(a){this.reset();this.toHide=this.errorsFor(a)},elementValue:function(b){var d,a=$(b),c=b.type;if(c==="radio"||c==="checkbox"){return $("input[name='"+b.name+"']:checked").val()}else{if(c==="number"&&typeof b.validity!=="undefined"){return b.validity.badInput?false:a.val()}}d=a.val();if(typeof d==="string"){return d.replace(/\r/g,"")}return d},check:function(c){c=this.validationTargetFor(this.clean(c));var h=$(c).rules(),f=$.map(h,function(k,e){return e}).length,i=false,b=this.elementValue(c),j,a,g;for(a in h){g={method:a,parameters:h[a]};try{j=$.validator.methods[a].call(this,b,c,g.parameters);if(j==="dependency-mismatch"&&f===1){i=true;continue}i=false;if(j==="pending"){this.toHide=this.toHide.not(this.errorsFor(c));return}if(!j){this.formatAndAdd(c,g);return false}}catch(d){if(this.settings.debug&&window.console){console.log("Exception occurred when checking element "+c.id+", check the '"+g.method+"' method.",d)}throw d}}if(i){return}if(this.objectLength(h)){this.successList.push(c)}return true},customDataMessage:function(a,b){return $(a).data("msg"+b.charAt(0).toUpperCase()+b.substring(1).toLowerCase())||$(a).data("msg")},customMessage:function(b,c){var a=this.settings.messages[b];return a&&(a.constructor===String?a:a[c])},findDefined:function(){for(var a=0;a<arguments.length;a++){if(arguments[a]!==undefined){return arguments[a]}}return undefined},defaultMessage:function(a,b){return this.findDefined(this.customMessage(a.name,b),this.customDataMessage(a,b),!this.settings.ignoreTitle&&a.title||undefined,$.validator.messages[b],"<strong>Warning: No message defined for "+a.name+"</strong>")},formatAndAdd:function(b,d){var c=this.defaultMessage(b,d.method),a=/\$?\{(\d+)\}/g;if(typeof c==="function"){c=c.call(this,d.parameters,b)}else{if(a.test(c)){c=$.validator.format(c.replace(a,"{$1}"),d.parameters)}}this.errorList.push({message:c,element:b,method:d.method});this.errorMap[b.name]=c;this.submitted[b.name]=c},addWrapper:function(a){if(this.settings.wrapper){a=a.add(a.parent(this.settings.wrapper))}return a},defaultShowErrors:function(){var b,c,a;for(b=0;this.errorList[b];b++){a=this.errorList[b];if(this.settings.highlight){this.settings.highlight.call(this,a.element,this.settings.errorClass,this.settings.validClass)}this.showLabel(a.element,a.message)}if(this.errorList.length){this.toShow=this.toShow.add(this.containers)}if(this.settings.success){for(b=0;this.successList[b];b++){this.showLabel(this.successList[b])}}if(this.settings.unhighlight){for(b=0,c=this.validElements();c[b];b++){this.settings.unhighlight.call(this,c[b],this.settings.errorClass,this.settings.validClass)}}this.toHide=this.toHide.not(this.toShow);this.hideErrors();this.addWrapper(this.toShow).show()},validElements:function(){return this.currentElements.not(this.invalidElements())},invalidElements:function(){return $(this.errorList).map(function(){return this.element})},showLabel:function(e,f){var b,h,d,c=this.errorsFor(e),a=this.idOrName(e),g=$(e).attr("aria-describedby");if(c.length){c.removeClass(this.settings.validClass).addClass(this.settings.errorClass);c.html(f)}else{c=$("<"+this.settings.errorElement+">").attr("id",a+"-error").addClass(this.settings.errorClass).html(f||"");b=c;if(this.settings.wrapper){b=c.hide().show().wrap("<"+this.settings.wrapper+"/>").parent()}if(this.labelContainer.length){this.labelContainer.append(b)}else{if(this.settings.errorPlacement){this.settings.errorPlacement(b,$(e))}else{b.insertAfter(e)}}if(c.is("label")){c.attr("for",a)}else{if(c.parents("label[for='"+a+"']").length===0){d=c.attr("id");if(!g){g=d}else{if(!g.match(new RegExp("\b"+d+"\b"))){g+=" "+d}}$(e).attr("aria-describedby",g);h=this.groups[e.name];if(h){$.each(this.groups,function(j,i){if(i===h){$("[name='"+j+"']",this.currentForm).attr("aria-describedby",c.attr("id"))}})}}}}if(!f&&this.settings.success){c.text("");if(typeof this.settings.success==="string"){c.addClass(this.settings.success)}else{this.settings.success(c,e)}}this.toShow=this.toShow.add(c)},errorsFor:function(c){var b=this.idOrName(c),d=$(c).attr("aria-describedby"),a="label[for='"+b+"'], label[for='"+b+"'] *";if(d){a=a+", #"+d.replace(/\s+/g,", #")}return this.errors().filter(a)},idOrName:function(a){return this.groups[a.name]||(this.checkable(a)?a.name:a.id||a.name)},validationTargetFor:function(a){if(this.checkable(a)){a=this.findByName(a.name).not(this.settings.ignore)[0]}return a},checkable:function(a){return(/radio|checkbox/i).test(a.type)},findByName:function(a){return $(this.currentForm).find("[name='"+a+"']")},getLength:function(b,a){switch(a.nodeName.toLowerCase()){case"select":return $("option:selected",a).length;case"input":if(this.checkable(a)){return this.findByName(a.name).filter(":checked").length}}return b.length},depend:function(b,a){return this.dependTypes[typeof b]?this.dependTypes[typeof b](b,a):true},dependTypes:{"boolean":function(a){return a},string:function(b,a){return !!$(b,a.form).length},"function":function(b,a){return b(a)}},optional:function(a){var b=this.elementValue(a);return !$.validator.methods.required.call(this,b,a)&&"dependency-mismatch"},startRequest:function(a){if(!this.pending[a.name]){this.pendingRequest++;this.pending[a.name]=true}},stopRequest:function(a,b){this.pendingRequest--;if(this.pendingRequest<0){this.pendingRequest=0}delete this.pending[a.name];if(b&&this.pendingRequest===0&&this.formSubmitted&&this.form()){$(this.currentForm).submit();this.formSubmitted=false}else{if(!b&&this.pendingRequest===0&&this.formSubmitted){$(this.currentForm).triggerHandler("invalid-form",[this]);this.formSubmitted=false}}},previousValue:function(a){return $.data(a,"previousValue")||$.data(a,"previousValue",{old:null,valid:true,message:this.defaultMessage(a,"remote")})}},classRuleSettings:{required:{required:true},email:{email:true},url:{url:true},date:{date:true},dateISO:{dateISO:true},number:{number:true},digits:{digits:true},creditcard:{creditcard:true}},addClassRules:function(a,b){if(a.constructor===String){this.classRuleSettings[a]=b}else{$.extend(this.classRuleSettings,a)}},classRules:function(b){var c={},a=$(b).attr("class");if(a){$.each(a.split(" "),function(){if(this in $.validator.classRuleSettings){$.extend(c,$.validator.classRuleSettings[this])}})}return c},attributeRules:function(b){var e={},a=$(b),c=b.getAttribute("type"),f,d;for(f in $.validator.methods){if(f==="required"){d=b.getAttribute(f);if(d===""){d=true}d=!!d}else{d=a.attr(f)}if(/min|max/.test(f)&&(c===null||/number|range|text/.test(c))){d=Number(d)}if(d||d===0){e[f]=d}else{if(c===f&&c!=="range"){e[f]=true}}}if(e.maxlength&&/-1|2147483647|524288/.test(e.maxlength)){delete e.maxlength}return e},dataRules:function(b){var e,c,d={},a=$(b);for(e in $.validator.methods){c=a.data("rule"+e.charAt(0).toUpperCase()+e.substring(1).toLowerCase());if(c!==undefined){d[e]=c}}return d},staticRules:function(b){var c={},a=$.data(b.form,"validator");if(a.settings.rules){c=$.validator.normalizeRule(a.settings.rules[b.name])||{}}return c},normalizeRules:function(b,a){$.each(b,function(e,d){if(d===false){delete b[e];return}if(d.param||d.depends){var c=true;switch(typeof d.depends){case"string":c=!!$(d.depends,a.form).length;break;case"function":c=d.depends.call(a,a);break}if(c){b[e]=d.param!==undefined?d.param:true}else{delete b[e]}}});$.each(b,function(c,d){b[c]=$.isFunction(d)?d(a):d});$.each(["minlength","maxlength"],function(){if(b[this]){b[this]=Number(b[this])}});$.each(["rangelength","range"],function(){var c;if(b[this]){if($.isArray(b[this])){b[this]=[Number(b[this][0]),Number(b[this][1])]}else{if(typeof b[this]==="string"){c=b[this].replace(/[\[\]]/g,"").split(/[\s,]+/);b[this]=[Number(c[0]),Number(c[1])]}}}});if($.validator.autoCreateRanges){if(b.min&&b.max){b.range=[b.min,b.max];delete b.min;delete b.max}if(b.minlength&&b.maxlength){b.rangelength=[b.minlength,b.maxlength];delete b.minlength;delete b.maxlength}}return b},normalizeRule:function(b){if(typeof b==="string"){var a={};$.each(b.split(/\s/),function(){a[this]=true});b=a}return b},addMethod:function(a,c,b){$.validator.methods[a]=c;$.validator.messages[a]=b!==undefined?b:$.validator.messages[a];if(c.length<3){$.validator.addClassRules(a,$.validator.normalizeRule(a))}},methods:{required:function(b,a,d){if(!this.depend(d,a)){return"dependency-mismatch"}if(a.nodeName.toLowerCase()==="select"){var c=$(a).val();return c&&c.length>0}if(this.checkable(a)){return this.getLength(b,a)>0}return $.trim(b).length>0},email:function(b,a){return this.optional(a)||/^[a-zA-Z0-9.!#$%&'*+\/=?^_`{|}~-]+@[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?(?:\.[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?)*$/.test(b)},url:function(b,a){return this.optional(a)||/^(https?|s?ftp):\/\/(((([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(%[\da-f]{2})|[!\$&'\(\)\*\+,;=]|:)*@)?(((\d|[1-9]\d|1\d\d|2[0-4]\d|25[0-5])\.(\d|[1-9]\d|1\d\d|2[0-4]\d|25[0-5])\.(\d|[1-9]\d|1\d\d|2[0-4]\d|25[0-5])\.(\d|[1-9]\d|1\d\d|2[0-4]\d|25[0-5]))|((([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])*([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])))\.)+(([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])*([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])))\.?)(:\d*)?)(\/((([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(%[\da-f]{2})|[!\$&'\(\)\*\+,;=]|:|@)+(\/(([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(%[\da-f]{2})|[!\$&'\(\)\*\+,;=]|:|@)*)*)?)?(\?((([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(%[\da-f]{2})|[!\$&'\(\)\*\+,;=]|:|@)|[\uE000-\uF8FF]|\/|\?)*)?(#((([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(%[\da-f]{2})|[!\$&'\(\)\*\+,;=]|:|@)|\/|\?)*)?$/i.test(b)},date:function(b,a){return this.optional(a)||!/Invalid|NaN/.test(new Date(b).toString())},dateISO:function(b,a){return this.optional(a)||/^\d{4}[\/\-](0?[1-9]|1[012])[\/\-](0?[1-9]|[12][0-9]|3[01])$/.test(b)},number:function(b,a){return this.optional(a)||/^-?(?:\d+|\d{1,3}(?:,\d{3})+)?(?:\.\d+)?$/.test(b)},digits:function(b,a){return this.optional(a)||/^\d+$/.test(b)},creditcard:function(e,b){if(this.optional(b)){return"dependency-mismatch"}if(/[^0-9 \-]+/.test(e)){return false}var f=0,d=0,a=false,g,c;e=e.replace(/\D/g,"");if(e.length<13||e.length>19){return false}for(g=e.length-1;g>=0;g--){c=e.charAt(g);d=parseInt(c,10);if(a){if((d*=2)>9){d-=9}}f+=d;a=!a}return(f%10)===0},length:function(c,a,d){var b=$.isArray(c)?c.length:this.getLength($.trim(c),a);return this.optional(a)||b==d},minlength:function(c,a,d){var b=$.isArray(c)?c.length:this.getLength($.trim(c),a);return this.optional(a)||b>=d},maxlength:function(c,a,d){var b=$.isArray(c)?c.length:this.getLength($.trim(c),a);return this.optional(a)||b<=d},rangelength:function(c,a,d){var b=$.isArray(c)?c.length:this.getLength($.trim(c),a);return this.optional(a)||(b>=d[0]&&b<=d[1])},min:function(b,a,c){return this.optional(a)||b>=c},max:function(b,a,c){return this.optional(a)||b<=c},range:function(b,a,c){return this.optional(a)||(b>=c[0]&&b<=c[1])},equal:function(b,a,c){return b===c},notEqual:function(b,a,c){return b!==c},equalTo:function(b,a,d){var c=$(d);if(this.settings.onfocusout){c.unbind(".validate-equalTo").bind("blur.validate-equalTo",function(){$(a).valid()})}return b===c.val()},remote:function(e,b,f){if(this.optional(b)){return"dependency-mismatch"}var c=this.previousValue(b),a,d;if(!this.settings.messages[b.name]){this.settings.messages[b.name]={}}c.originalMessage=this.settings.messages[b.name].remote;this.settings.messages[b.name].remote=c.message;f=typeof f==="string"&&{url:f}||f;if(c.old===e){return c.valid}c.old=e;a=this;this.startRequest(b);d={tm:parseInt(Math.random()*100000000)};if(f.paramName){d[f.paramName]=e}else{d[b.name]=e}$.ajax($.extend(true,{url:f,mode:"abort",port:"validate"+b.name,dataType:"json",data:d,context:a.currentForm,success:function(h){var j=h===true||h==="true",k,i,g;if($.isFunction(f.checkFunction)){j=f.checkFunction(b,h)}a.settings.messages[b.name].remote=c.originalMessage;if(j){g=a.formSubmitted;a.prepareElement(b);a.formSubmitted=g;a.successList.push(b);delete a.invalid[b.name];a.showErrors()}else{k={};i=a.defaultMessage(b,"remote");if($.isFunction(f.getMessage)){i=f.getMessage(b,h)}k[b.name]=c.message=$.isFunction(i)?i(e):i;a.invalid[b.name]=true;a.showErrors(k)}c.valid=j;a.stopRequest(b,j)}},f));return"pending"}}});$.format=function deprecated(){throw"$.format has been deprecated. Please use $.validator.format instead."};var pendingRequests={},ajax;if($.ajaxPrefilter){$.ajaxPrefilter(function(c,b,d){var a=c.port;if(c.mode==="abort"){if(pendingRequests[a]){pendingRequests[a].abort()}pendingRequests[a]=d}})}else{ajax=$.ajax;$.ajax=function(b){var c=("mode" in b?b:$.ajaxSettings).mode,a=("port" in b?b:$.ajaxSettings).port;if(c==="abort"){if(pendingRequests[a]){pendingRequests[a].abort()}pendingRequests[a]=ajax.apply(this,arguments);return pendingRequests[a]}return ajax.apply(this,arguments)}}$.extend($.fn,{validateDelegate:function(c,b,a){return this.bind(b,function(d){var e=$(d.target);if(e.is(c)){return a.apply(e,arguments)}})}});

	// jquery.form.js
	var e = $;
	var c={};c.fileapi=e("<input type='file'/>").get(0).files!==undefined;c.formdata=window.FormData!==undefined;e.fn.ajaxSubmit=function(h){if(!this.length){d("ajaxSubmit: skipping submit process - no element selected");return this}var g,y,j,m=this;if(typeof h=="function"){h={success:h}}g=this.attr("method");y=this.attr("action");j=(typeof y==="string")?e.trim(y):"";j=j||window.location.href||"";if(j){j=(j.match(/^([^#]+)/)||[])[1]}h=e.extend(true,{url:j,success:e.ajaxSettings.success,type:g||"GET",iframeSrc:/^https/i.test(window.location.href||"")?"javascript:false":"about:blank"},h);var s={};this.trigger("form-pre-serialize",[this,h,s]);if(s.veto){d("ajaxSubmit: submit vetoed via form-pre-serialize trigger");return this}if(h.beforeSerialize&&h.beforeSerialize(this,h)===false){d("ajaxSubmit: submit aborted via beforeSerialize callback");return this}var l=h.traditional;if(l===undefined){l=e.ajaxSettings.traditional}var p=[];var B,C=this.formToArray(h.semantic,p);if(h.data){h.extraData=h.data;B=e.param(h.data,l)}if(h.beforeSubmit&&h.beforeSubmit(C,this,h)===false){d("ajaxSubmit: submit aborted via beforeSubmit callback");return this}this.trigger("form-submit-validate",[C,this,h,s]);if(s.veto){d("ajaxSubmit: submit vetoed via form-submit-validate trigger");return this}var w=e.param(C,l);if(B){w=(w?(w+"&"+B):B)}if(h.type.toUpperCase()=="GET"){h.url+=(h.url.indexOf("?")>=0?"&":"?")+w;h.data=null}else{h.data=w}var E=[];if(h.resetForm){E.push(function(){m.resetForm()})}if(h.clearForm){E.push(function(){m.clearForm(h.includeHidden)})}if(!h.dataType&&h.target){var i=h.success||function(){};E.push(function(q){var k=h.replaceTarget?"replaceWith":"html";e(h.target)[k](q).each(i,arguments)})}else{if(h.success){E.push(h.success)}}h.success=function(H,q,I){var G=h.context||this;for(var F=0,k=E.length;F<k;F++){E[F].apply(G,[H,q,I||m,m])}};var A=e('input[type=file]:enabled[value!=""]',this);var n=A.length>0;var z="multipart/form-data";var v=(m.attr("enctype")==z||m.attr("encoding")==z);var u=c.fileapi&&c.formdata;d("fileAPI :"+u);var o=(n||v)&&!u;var t;if(h.iframe!==false&&(h.iframe||o)){if(h.closeKeepAlive){e.get(h.closeKeepAlive,function(){t=D(C)})}else{t=D(C)}}else{if((n||v)&&u){t=r(C)}else{t=e.ajax(h)}}m.removeData("jqxhr").data("jqxhr",t);for(var x=0;x<p.length;x++){p[x]=null}this.trigger("form-submit-notify",[this,h]);return this;function f(H){var I=e.param(H).split("&");var q=I.length;var k={};var G,F;for(G=0;G<q;G++){F=I[G].split("=");k[decodeURIComponent(F[0])]=decodeURIComponent(F[1])}return k}function r(q){var k=new FormData();for(var F=0;F<q.length;F++){k.append(q[F].name,q[F].value)}if(h.extraData){var I=f(h.extraData);for(var J in I){if(I.hasOwnProperty(J)){k.append(J,I[J])}}}h.data=null;var H=e.extend(true,{},e.ajaxSettings,h,{contentType:false,processData:false,cache:false,type:g||"POST"});if(h.uploadProgress){H.xhr=function(){var K=jQuery.ajaxSettings.xhr();if(K.upload){K.upload.onprogress=function(O){var N=0;var L=O.loaded||O.position;var M=O.total;if(O.lengthComputable){N=Math.ceil(L/M*100)}h.uploadProgress(O,L,M,N)}}return K}}H.data=null;var G=H.beforeSend;H.beforeSend=function(L,K){K.data=k;if(G){G.call(this,L,K)}};return e.ajax(H)}function D(ad){var I=m[0],H,Z,T,ab,W,K,O,M,N,X,aa,R;var L=!!e.fn.prop;var ag=e.Deferred();if(e("[name=submit],[id=submit]",I).length){alert('Error: Form elements must not have name or id of "submit".');ag.reject();return ag}if(ad){for(Z=0;Z<p.length;Z++){H=e(p[Z]);if(L){H.prop("disabled",false)}else{H.removeAttr("disabled")}}}T=e.extend(true,{},e.ajaxSettings,h);T.context=T.context||T;W="jqFormIO"+(new Date().getTime());if(T.iframeTarget){K=e(T.iframeTarget);X=K.attr("name");if(!X){K.attr("name",W)}else{W=X}}else{K=e('<iframe name="'+W+'" src="'+T.iframeSrc+'" />');K.css({position:"absolute",top:"-1000px",left:"-1000px"})}O=K[0];M={aborted:0,responseText:null,responseXML:null,status:0,statusText:"n/a",getAllResponseHeaders:function(){},getResponseHeader:function(){},setRequestHeader:function(){},abort:function(ah){var ai=(ah==="timeout"?"timeout":"aborted");d("aborting upload... "+ai);this.aborted=1;if(O.contentWindow.document.execCommand){try{O.contentWindow.document.execCommand("Stop")}catch(aj){}}K.attr("src",T.iframeSrc);M.error=ai;if(T.error){T.error.call(T.context,M,ai,ah)}if(ab){e.event.trigger("ajaxError",[M,T,ai])}if(T.complete){T.complete.call(T.context,M,ai)}}};ab=T.global;if(ab&&0===e.active++){e.event.trigger("ajaxStart")}if(ab){e.event.trigger("ajaxSend",[M,T])}if(T.beforeSend&&T.beforeSend.call(T.context,M,T)===false){if(T.global){e.active--}ag.reject();return ag}if(M.aborted){ag.reject();return ag}N=I.clk;if(N){X=N.name;if(X&&!N.disabled){T.extraData=T.extraData||{};T.extraData[X]=N.value;if(N.type=="image"){T.extraData[X+".x"]=I.clk_x;T.extraData[X+".y"]=I.clk_y}}}var S=1;var P=2;function Q(ai){var ah=ai.contentWindow?ai.contentWindow.document:ai.contentDocument?ai.contentDocument:ai.document;return ah}var G=e("meta[name=csrf-token]").attr("content");var F=e("meta[name=csrf-param]").attr("content");if(F&&G){T.extraData=T.extraData||{};T.extraData[F]=G}function Y(){var aj=m.attr("target"),ah=m.attr("action");I.setAttribute("target",W);if(!g){I.setAttribute("method","POST")}if(ah!=T.url){I.setAttribute("action",T.url)}if(!T.skipEncodingOverride&&(!g||/post/i.test(g))){m.attr({encoding:"multipart/form-data",enctype:"multipart/form-data"})}if(T.timeout){R=setTimeout(function(){aa=true;V(S)},T.timeout)}function ak(){try{var am=Q(O).readyState;d("state = "+am);if(am&&am.toLowerCase()=="uninitialized"){setTimeout(ak,50)}}catch(an){d("Server abort: ",an," (",an.name,")");V(P);if(R){clearTimeout(R)}R=undefined}}var ai=[];try{if(T.extraData){for(var al in T.extraData){if(T.extraData.hasOwnProperty(al)){if(e.isPlainObject(T.extraData[al])&&T.extraData[al].hasOwnProperty("name")&&T.extraData[al].hasOwnProperty("value")){ai.push(e('<input type="hidden" name="'+T.extraData[al].name+'">').attr("value",T.extraData[al].value).appendTo(I)[0])}else{ai.push(e('<input type="hidden" name="'+al+'">').attr("value",T.extraData[al]).appendTo(I)[0])}}}}if(!T.iframeTarget){K.appendTo("body");if(O.attachEvent){O.attachEvent("onload",V)}else{O.addEventListener("load",V,false)}}setTimeout(ak,15);I.submit()}finally{I.setAttribute("action",ah);if(aj){I.setAttribute("target",aj)}else{m.removeAttr("target")}e(ai).remove()}}if(T.forceSync){Y()}else{setTimeout(Y,10)}var ae,af,ac=50,J;function V(am){if(M.aborted||J){return}try{af=Q(O)}catch(ap){d("cannot access response document: ",ap);am=P}if(am===S&&M){M.abort("timeout");ag.reject(M,"timeout");return}else{if(am==P&&M){M.abort("server abort");ag.reject(M,"error","server abort");return}}if(!af||af.location.href==T.iframeSrc){if(!aa){return}}if(O.detachEvent){O.detachEvent("onload",V)}else{O.removeEventListener("load",V,false)}var ak="success",ao;try{if(aa){throw"timeout"}var aj=T.dataType=="xml"||af.XMLDocument||e.isXMLDoc(af);d("isXml="+aj);if(!aj&&window.opera&&(af.body===null||!af.body.innerHTML)){if(--ac){d("requeing onLoad callback, DOM not available");setTimeout(V,250);return}}var aq=af.body?af.body:af.documentElement;M.responseText=aq?aq.innerHTML:null;M.responseXML=af.XMLDocument?af.XMLDocument:af;if(aj){T.dataType="xml"}M.getResponseHeader=function(au){var at={"content-type":T.dataType};return at[au]};if(aq){M.status=Number(aq.getAttribute("status"))||M.status;M.statusText=aq.getAttribute("statusText")||M.statusText}var ah=(T.dataType||"").toLowerCase();var an=/(json|script|text)/.test(ah);if(an||T.textarea){var al=af.getElementsByTagName("textarea")[0];if(al){M.responseText=al.value;M.status=Number(al.getAttribute("status"))||M.status;M.statusText=al.getAttribute("statusText")||M.statusText}else{if(an){var ai=af.getElementsByTagName("pre")[0];var ar=af.getElementsByTagName("body")[0];if(ai){M.responseText=ai.textContent?ai.textContent:ai.innerText}else{if(ar){M.responseText=ar.textContent?ar.textContent:ar.innerText}}}}}else{if(ah=="xml"&&!M.responseXML&&M.responseText){M.responseXML=U(M.responseText)}}try{ae=k(M,ah,T)}catch(am){ak="parsererror";M.error=ao=(am||ak)}}catch(am){d("error caught: ",am);ak="error";M.error=ao=(am||ak)}if(M.aborted){d("upload aborted");ak=null}if(M.status){ak=(M.status>=200&&M.status<300||M.status===304)?"success":"error"}if(ak==="success"){if(T.success){T.success.call(T.context,ae,"success",M)}ag.resolve(M.responseText,"success",M);if(ab){e.event.trigger("ajaxSuccess",[M,T])}}else{if(ak){if(ao===undefined){ao=M.statusText}if(T.error){T.error.call(T.context,M,ak,ao)}ag.reject(M,"error",ao);if(ab){e.event.trigger("ajaxError",[M,T,ao])}}}if(ab){e.event.trigger("ajaxComplete",[M,T])}if(ab&&!--e.active){e.event.trigger("ajaxStop")}if(T.complete){T.complete.call(T.context,M,ak)}J=true;if(T.timeout){clearTimeout(R)}setTimeout(function(){if(!T.iframeTarget){K.remove()}M.responseXML=null},100)}var U=e.parseXML||function(ah,ai){if(window.ActiveXObject){ai=new ActiveXObject("Microsoft.XMLDOM");ai.async="false";ai.loadXML(ah)}else{ai=(new DOMParser()).parseFromString(ah,"text/xml")}return(ai&&ai.documentElement&&ai.documentElement.nodeName!="parsererror")?ai:null};var q=e.parseJSON||function(ah){return window["eval"]("("+ah+")")};var k=function(am,ak,aj){var ai=am.getResponseHeader("content-type")||"",ah=ak==="xml"||!ak&&ai.indexOf("xml")>=0,al=ah?am.responseXML:am.responseText;if(ah&&al.documentElement.nodeName==="parsererror"){if(e.error){e.error("parsererror")}}if(aj&&aj.dataFilter){al=aj.dataFilter(al,ak)}if(typeof al==="string"){if(ak==="json"||!ak&&ai.indexOf("json")>=0){al=q(al)}else{if(ak==="script"||!ak&&ai.indexOf("javascript")>=0){e.globalEval(al)}}}return al};return ag}};e.fn.ajaxForm=function(f){f=f||{};f.delegation=f.delegation&&e.isFunction(e.fn.on);if(!f.delegation&&this.length===0){var g={s:this.selector,c:this.context};if(!e.isReady&&g.s){d("DOM not ready, queuing ajaxForm");e(function(){e(g.s,g.c).ajaxForm(f)});return this}d("terminating; zero elements found by selector"+(e.isReady?"":" (DOM not ready)"));return this}if(f.delegation){e(document).off("submit.form-plugin",this.selector,b).off("click.form-plugin",this.selector,a).on("submit.form-plugin",this.selector,f,b).on("click.form-plugin",this.selector,f,a);return this}return this.ajaxFormUnbind().bind("submit.form-plugin",f,b).bind("click.form-plugin",f,a)};function b(g){var f=g.data;if(!g.isDefaultPrevented()){g.preventDefault();e(this).ajaxSubmit(f)}}function a(j){var i=j.target;var g=e(i);if(!(g.is("[type=submit],[type=image]"))){var f=g.closest("[type=submit]");if(f.length===0){return}i=f[0]}var h=this;h.clk=i;if(i.type=="image"){if(j.offsetX!==undefined){h.clk_x=j.offsetX;h.clk_y=j.offsetY}else{if(typeof e.fn.offset=="function"){var k=g.offset();h.clk_x=j.pageX-k.left;h.clk_y=j.pageY-k.top}else{h.clk_x=j.pageX-i.offsetLeft;h.clk_y=j.pageY-i.offsetTop}}}setTimeout(function(){h.clk=h.clk_x=h.clk_y=null},100)}e.fn.ajaxFormUnbind=function(){return this.unbind("submit.form-plugin click.form-plugin")};e.fn.formToArray=function(w,f){var u=[];if(this.length===0){return u}var k=this[0];var o=w?k.getElementsByTagName("*"):k.elements;if(!o){return u}var q,p,m,x,l,s,h;for(q=0,s=o.length;q<s;q++){l=o[q];m=l.name;if(!m){continue}if(w&&k.clk&&l.type=="image"){if(!l.disabled&&k.clk==l){u.push({name:m,value:e(l).val(),type:l.type});u.push({name:m+".x",value:k.clk_x},{name:m+".y",value:k.clk_y})}continue}x=e.fieldValue(l,true);if(x&&x.constructor==Array){if(f){f.push(l)}for(p=0,h=x.length;p<h;p++){u.push({name:m,value:x[p]})}}else{if(c.fileapi&&l.type=="file"&&!l.disabled){if(f){f.push(l)}var g=l.files;if(g.length){for(p=0;p<g.length;p++){u.push({name:m,value:g[p],type:l.type})}}else{u.push({name:m,value:"",type:l.type})}}else{if(x!==null&&typeof x!="undefined"){if(f){f.push(l)}u.push({name:m,value:x,type:l.type,required:l.required})}}}}if(!w&&k.clk){var r=e(k.clk),t=r[0];m=t.name;if(m&&!t.disabled&&t.type=="image"){u.push({name:m,value:r.val()});u.push({name:m+".x",value:k.clk_x},{name:m+".y",value:k.clk_y})}}return u};e.fn.formSerialize=function(f){return e.param(this.formToArray(f))};e.fn.fieldSerialize=function(g){var f=[];this.each(function(){var l=this.name;if(!l){return}var j=e.fieldValue(this,g);if(j&&j.constructor==Array){for(var k=0,h=j.length;k<h;k++){f.push({name:l,value:j[k]})}}else{if(j!==null&&typeof j!="undefined"){f.push({name:this.name,value:j})}}});return e.param(f)};e.fn.fieldValue=function(l){for(var k=[],h=0,f=this.length;h<f;h++){var j=this[h];var g=e.fieldValue(j,l);if(g===null||typeof g=="undefined"||(g.constructor==Array&&!g.length)){continue}if(g.constructor==Array){e.merge(k,g)}else{k.push(g)}}return k};e.fieldValue=function(f,m){var h=f.name,s=f.type,u=f.tagName.toLowerCase();if(m===undefined){m=true}if(m&&(!h||f.disabled||s=="reset"||s=="button"||(s=="checkbox"||s=="radio")&&!f.checked||(s=="submit"||s=="image")&&f.form&&f.form.clk!=f||u=="select"&&f.selectedIndex==-1)){return null}if(u=="select"){var o=f.selectedIndex;if(o<0){return null}var q=[],g=f.options;var k=(s=="select-one");var p=(k?o+1:g.length);for(var j=(k?o:0);j<p;j++){var l=g[j];if(l.selected){var r=l.value;if(!r){r=(l.attributes&&l.attributes.value&&!(l.attributes.value.specified))?l.text:l.value}if(k){return r}q.push(r)}}return q}return e(f).val()};e.fn.clearForm=function(f){return this.each(function(){e("input,select,textarea",this).clearFields(f)})};e.fn.clearFields=e.fn.clearInputs=function(f){var g=/^(?:color|date|datetime|email|month|number|password|range|search|tel|text|time|url|week)$/i;return this.each(function(){var i=this.type,h=this.tagName.toLowerCase();if(g.test(i)||h=="textarea"){this.value=""}else{if(i=="checkbox"||i=="radio"){this.checked=false}else{if(h=="select"){this.selectedIndex=-1}else{if(f){if((f===true&&/hidden/.test(i))||(typeof f=="string"&&e(this).is(f))){this.value=""}}}}}})};e.fn.resetForm=function(){return this.each(function(){if(typeof this.reset=="function"||(typeof this.reset=="object"&&!this.reset.nodeType)){this.reset()}})};e.fn.enable=function(f){if(f===undefined){f=true}return this.each(function(){this.disabled=!f})};e.fn.selected=function(f){if(f===undefined){f=true}return this.each(function(){var g=this.type;if(g=="checkbox"||g=="radio"){this.checked=f}else{if(this.tagName.toLowerCase()=="option"){var h=e(this).parent("select");if(f&&h[0]&&h[0].type=="select-one"){h.find("option").selected(false)}this.selected=f}}})};e.fn.ajaxSubmit.debug=false;function d(){if(!e.fn.ajaxSubmit.debug){return}var f="[jquery.form] "+Array.prototype.join.call(arguments,"");if(window.console&&window.console.log){window.console.log(f)}else{if(window.opera&&window.opera.postError){window.opera.postError(f)}}};

	$.fn.extend({
		asyncForm: function(config) {
			var defConfig = {
				validate: {
					errorClass: "u-form-error",
					validClass: "u-form-valid",
					success: "form-valid",
					submitHandler: function (form) {
						$(form).ajaxSubmit();
					}
				}
			};
			config = $.extend({}, defConfig, config);
			this.each(function() {
				if (this.nodeName.toLowerCase() !== "form") {
					return;
				}

				var $form = $(this);
				if (config.validate !== false) {
					$form.validate(config.validate);
				}
			});
		}
	});
}));
